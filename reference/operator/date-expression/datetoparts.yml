type: operator
category: date-expression
name: $dateToParts
description: Used to extract individual components (Year, Month, Day, Hour, Minute, Second, Millisecond, etc.) from a date object. The operator is useful for scenarios where manipulation or analysis of specific date parts is required, such as sorting, filtering, or aggregating data based on individual date components.
syntax: "$dateToParts: { date: <dateExpression>, timezone: <string>, iso8601: <boolean> }"
parameters:
  - name: date
    type: object
    required: true
    description: The date expression to extract parts from.
  - name: timezone
    type: string
    required: false
    description: Optional. Specifies the timezone for the date. Defaults to UTC if not provided.
  - name: iso8601
    type: object
    required: false
    description: Optional. If true, the operator uses ISO 8601 week date calendar system. Defaults to false.
examples:
  items:
    - title: Extracting date parts from a field
      description: This query uses $dateToParts to break down the lastUpdated date into components like year, month, day, and time. It helps in analyzing or transforming individual parts of a date for further processing.
      query: |
        db.stores.aggregate([
          {
            $match: { _id: "e6410bb3-843d-4fa6-8c70-7472925f6d0a" }
          },
          {
            $project: {
              _id: 0,
              dateParts: {
                $dateToParts: { 
                  date: "$lastUpdated" 
                }
              }
            }
          }
        ])
      output:
        value: |
          [
            {
              "dateParts": {
                "year": 2024,
                "month": 12,
                "day": 4,
                "hour": 11,
                "minute": 50,
                "second": 6,
                "millisecond": 0
              }
            }
          ]
    - title: Using timezone
      description: This query extracts the lastUpdated timestamp of a specific document and breaks it into date parts like year, month, day, and hour using $dateToParts. Including the "America/New_York" timezone permits the breakdown, reflects the local time instead of UTC.
      query: |
        db.stores.aggregate([
          {
            $match: { _id: "e6410bb3-843d-4fa6-8c70-7472925f6d0a" }
          },
          {
            $project: {
              _id: 0,
              datePartsWithTimezone: {
                $dateToParts: { 
                  date: "$lastUpdated", 
                  timezone: "America/New_York" 
                }
              }
            }
          }
        ])
      output:
        value: |
          [
            {
              "datePartsWithTimezone": {
                "year": 2024,
                "month": 12,
                "day": 4,
                "hour": 6,
                "minute": 50,
                "second": 6,
                "millisecond": 0
              }
            }
          ]
related:
  - reference: $dateFromParts
  - reference: $dateToString
  - reference: $year
