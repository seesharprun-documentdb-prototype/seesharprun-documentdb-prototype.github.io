type: operator
category: accumulator
name: $count
description: |-
  The `$count` operator is used to count the number of documents that match a specified query filter. The count operator is useful for summarizing data or generating counts for specific groupings.
syntax: |-
  {
    $count: "<fieldName>"
  }
parameters:
  - name: fieldName
    type: string
    required: true
    description: |-
      The name of the field in the output document where the count will be stored.
examples:
  sample: |-
    {
      "_id": "0fcc0bf0-ed18-4ab8-b558-9848e18058f4",
      "name": "First Up Consultants | Beverage Shop",
      "sales": {
        "salesByCategory": [
          { "categoryName": "Wine Accessories" }
        ]
      },
      "promotionEvents": [
        { "eventName": "Unbeatable Bargain Bash" }
      ]
    }
  items:
    - title: Retrieve the count of all documents
      explanation: |-
        Count all documents in the collection without any filters.
      description: |-
        This query uses $count to return the total number of documents.
      query: |-
        db.stores.aggregate([
          { $count: "totalDocuments" }
        ])
      output:
        value: |-
          [
            { "totalDocuments": 41501 }
          ]
    - title: Count documents grouped by a specific field
      explanation: |-
        Count documents within each sales category by grouping and counting.
      description: |-
        This query unwinds categories, groups by category name, and counts documents per category.
      query: |-
        db.stores.aggregate([
          { $unwind: "$sales.salesByCategory" },
          {
            $group: {
              _id: "$sales.salesByCategory.categoryName",
              totalCount: { $count: {} }
            }
          }
        ])
      output:
        value: |-
          [
            { "_id": "Christmas Trees", "totalCount": 93 },
            { "_id": "Nuts", "totalCount": 83 },
            { "_id": "Camping Tables", "totalCount": 130 }
          ]
    - title: Count the number of promotion events
      explanation: |-
        Count all promotion events across stores by unwinding and counting.
      description: |-
        This query unwinds the promotionEvents array and counts total events.
      query: |-
        db.stores.aggregate([
          { $unwind: "$promotionEvents" },
          { $count: "totalPromotionEvents" }
        ])
      output:
        value: |-
          [
            { "totalPromotionEvents": 145673 }
          ]
related:
  - reference: /command/aggregation/count
  - reference: /operator/aggregation/group
